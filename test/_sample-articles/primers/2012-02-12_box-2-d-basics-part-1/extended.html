<div class="recycle">Article imported from <em>http://sierakowski.eu/list-of-tips/114-box2d-basics-part-1.html</em></div>
<p><span style="text-align: justify;">There are two latest major versions of Box2D, 2.0 and 2.1 and there are not compatible. It means code written in 2.0 will not work in 2.1. There aren't big changes but just giving you a heads up that when following 2.0 tutorials but working with 2.1 libraries plugged in to your IDE you may experience problems.</span></p>
<p style="text-align: justify;">When you start working with Box2D you will quickly realise that all data types are prefixed with b2. This is to eliminate a risk of having conflicts in naming between the framework and your project.</p>
<p>&nbsp;</p>
<h2>Units</h2>
<p>Before start coding, there is one important value that we need to set:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> const pixelsPerMeter<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">30</span>;</span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">Quoting the manual: "Box2D works with floating point numbers, so some tolerances have to be used to make Box2D perform well. These tolerance have been tuned to work well with meters-kilogram-second (MKS) units. In particular, Box2D has been tuned to work
    well with moving objects between 0.1 and 10 meters. So this means objects between soup cans and buses in size should work well."</p>
<p style="text-align: justify;">We don't want one pixel represent one meter as considering our stage size, some objects that are 1000 pixels long would have one kilometer in Box2D world. The standard is that one pixel will be represented by 1/30 meter. This means that when working with
    objects, specifying their sizes or positions, we will need to convert pixels to meters. To make it easier let's create a helper function that will do a conversion for us:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> p2m<span style="color: #000000;">(</span>pixels<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">return</span> pixels <span style="color: #000000; font-weight: bold;">/</span> pixelsPerMeter;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<h2>Debug Draw</h2>
<p style="text-align: justify;">We are going to use the debug drawing to see the graphical representation of what is happening in our world. This isn't a necessary step, but remember that Box2D operates on numbers and returns numbers.</p>
<p style="text-align: justify;">As the name implies this is only for debugging and you won't be using this in your games. Later on we will look at using our own graphical assets, we will be reading physical objects positions and move our sprites or bitmaps accordingly.</p>
<p>Debug draw can show the following things:</p>
<ul>
    <li>shape outlines</li>
    <li>joint connectivity</li>
    <li>core shapes (for continuous collision)</li>
    <li>broad-phase axis-aligned bounding boxes (AABBs), including the world AABB</li>
    <li>polygon oriented bounding boxes (OBBs)</li>
    <li>broad-phase pairs (potential contacts)</li>
    <li>center of mass</li>
</ul>
<p style="text-align: justify;">You can customise your view using drawFlags that are defined in the b2DebugDraw class.</p>
<p style="text-align: justify;">Let's declare our debugDraw globally and create createDebugDraw function:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #6699cc; font-weight: bold;">var</span> debugDraw<span style="color: #000000; font-weight: bold;">:</span>b2DebugDraw;</span>

<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> initDebugDraw<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  debugDraw = <span style="color: #0033ff; font-weight: bold;">new</span> b2DebugDraw<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> debugSprite<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=sprite%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:sprite.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Sprite</span></a> = <span style="color: #0033ff; font-weight: bold;">new</span> <a href="http://www.google.com/search?q=sprite%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:sprite.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Sprite</span></a><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #004993;">addChild</span><span style="color: #000000;">(</span>debugSprite<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  debugDraw.SetSprite<span style="color: #000000;">(</span>debugSprite<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  debugDraw.SetDrawScale<span style="color: #000000;">(</span>pixelsPerMeter<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  debugDraw.SetFillAlpha<span style="color: #000000;">(</span>.3<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  debugDraw.SetLineThickness<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">1.0</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  debugDraw.SetFlags<span style="color: #000000;">(</span>b2DebugDraw.e_shapeBit <span style="color: #000000; font-weight: bold;">|</span> b2DebugDraw.e_jointBit<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  ourWorld.SetDebugDraw<span style="color: #000000;">(</span>debugDraw<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">Then just in few moments, when we create a world object and the update function called on every step, we also call the DrawDebudData method to update the view and reflect changes in the physics world:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;">ourWorld.DrawDebugData<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span></pre>
        </div>
    </div>
</div>
<p style="text-align: justify;">&nbsp;</p>
<p style="text-align: justify;">And that would be it about the debug view. However, for the purpose of this tutorial, I wanted to make it easier to change the debug view at runtime and read information about the main object - our hero's position, speed and collisions. I used components
    (minimalcomps from bit101) and created buttons representing each type of debug view. Have a look at the final code for this tutorial to see the implementation.</p>
<p>&nbsp;</p>
<h2>World creation</h2>
<p style="text-align: justify;">World object of type b2World is the physics hub that manages memory, objects, and simulation and it's the first thing that we create.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #6699cc; font-weight: bold;">var</span> ourWorld<span style="color: #000000; font-weight: bold;">:</span>b2World;</span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">To keep everything clean let's create the "createWorld" function that will set up our world. Constructor of b2World takes two parameters, a gravity vector and a boolean indicating whether bodies will be allowed to sleep. In our case the gravity will be
    on y axis down (as in our real world) and bodies are allowed to sleep (if there are no collisions bodies will be temporary disabled to save CPU some work).</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #6699cc; font-weight: bold;">var</span> createWorld<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> gravity<span style="color: #000000; font-weight: bold;">:</span>b2Vec2 = <span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">0.0</span>, <span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">10.0</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> doSleep<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Boolean</span></a> = <span style="color: #0033ff; font-weight: bold;">true</span>;</span>

<span style="vertical-align: top;">  ourWorld = <span style="color: #0033ff; font-weight: bold;">new</span> b2World<span style="color: #000000;">(</span>gravity, doSleep<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<h2>Conducting simulation</h2>
<p style="text-align: justify;"><span style="line-height: 26.383333206176758px;">Let's create two more constants. The first is a time-step which is number of steps in a second is needed for the Integrator, the part of Box2D which simulates physics equations at discrete points of time. This value shouldn't be changed.</span></p>
<div class="rj_insertcode" style="line-height: 26.383333206176758px;">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> const timeStep<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">1.0</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">60.0</span>;</span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">The second is a number of iterations for the Constraint Solver which is responsible for solving constraints in the simulation. We surely need more than one at a time step as "when we solve one constraint, we slightly disrupt other constraints. The iteration
    count controls how many times the constraint solver sweeps over all the contacts and joints in the world. More iterations always yields a better simulation. But don't trade a small time step for a large iteration count. 60Hz and 10 iterations is far
    better than 30Hz and 20 iterations."</p>
<div class="rj_insertcode" style="line-height: 26.383333206176758px;">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> const iterations<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">10</span>;</span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">In order to get the simulation working we need to plug it to a loop. We should avoid Box2D updates depending on a frame rate (that may be changing depending on the CPU load) but in Flash because of the way how the code execution is tied in to frames generation,
    we just use a standard enterFrame event. Let's create the update function that will be plugged to ENTER_FRAME listener.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> updatePhysics<span style="color: #000000;">(</span>e<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=event%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:event.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Event</span></a> = <span style="color: #0033ff; font-weight: bold;">null</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  ourWorld.Step<span style="color: #000000;">(</span>timeStep, iterations, iterations<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  ourWorld.ClearForces<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  ourWorld.DrawDebugData<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">To perform a step we need to pass our time-step value and iterations values for velocity and position iterations. After each step we clearForces and also update our debug view.</p>
<p>&nbsp;</p>
<h2>Creating objects</h2>
<p style="text-align: justify;">This might look a bit complicated at first but it makes sense when you get some practise and better understanding of Box2D.</p>
<p>There are three major sub-objects that create a complete physical object: shape, fixture and body.</p>
<ul>
    <li><strong>Shape </strong>defines a geometric shape of an object such as radius for circle, vertices for polygons. It is used to calculate a mass of an object and for collision detection.</li>
    <li><strong>Fixture </strong>defines material properties of an object such as density and friction. It also allows to add a userData - a pointer to an object containing data defined by yourself.</li>
    <li><strong>Body </strong>uses fixtures and shapes and defines position in the world and object's velocity.</li>
</ul>
<p>&nbsp;</p>
<p style="text-align: center;"><img src="http://sierakowski.eu/examples/box2d_part1/BodiesFixturesShapes.jpg" alt="Bodies Fixtures Shapes explanation" /></p>
<h3>&nbsp;</h3>
<h3><br />Creating static objects</h3>
<p style="text-align: justify;">There are three types of bodies: static, dynamic and kinetic (the last one introduced in v2.1). The main feature of bodies is that you can apply forces, torques, and impulses to them. Static bodies have mass equal to zero, never move and don't collide
    with other static bodies. Bodies are always rigid bodies which meant that two shapes attached to the same rigid body never move relative to each other.</p>
<p style="text-align: justify;">We will create four static bodies that will be walls in our world. Let's create the createWorldWalls function for that purpose. In order to create a body we need to create a body definition first that will be used to specify mass and position. The default
    mass is zero and since we are creating static bodies this is what we need. Let our wall have thickness of 50 pixels and width and height matching our game width and height size. Note that when creating shapes, the constructors take half of the width
    and half of the height. When positioning bodies however, Box2D sets position of the center of an object, not the top left like in Flash, so we have to add the middle (width/2, height/2) to the position to get it where we actually want to have it.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> static const GAME_AREA_WIDTH  <span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">500</span>;</span>
<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> static const GAME_AREA_HEIGHT <span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">400</span>;</span>

<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> createWorldWalls<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> wallThickness<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">10</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> wallWidth<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">490</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> wallHeight<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">390</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// Definitions can be reused</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> wallShape<span style="color: #000000; font-weight: bold;">:</span>b2PolygonShape = <span style="color: #0033ff; font-weight: bold;">new</span> b2PolygonShape<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> wallBodyDef<span style="color: #000000; font-weight: bold;">:</span>b2BodyDef = <span style="color: #0033ff; font-weight: bold;">new</span> b2BodyDef<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> wallBody<span style="color: #000000; font-weight: bold;">:</span>b2Body;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// Left / right wall shape</span></span>
<span style="vertical-align: top;">  wallShape.SetAsBox<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span>wallThickness <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span>wallHeight <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// left</span></span>
<span style="vertical-align: top;">  wallBodyDef.<span style="color: #004993;">position</span>.Set<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span>wallThickness<span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span>GAME_AREA_HEIGHT <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  wallBody = ourWorld.CreateBody<span style="color: #000000;">(</span>wallBodyDef<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  wallBody.CreateFixture2<span style="color: #000000;">(</span>wallShape<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// right</span></span>
<span style="vertical-align: top;">  wallBodyDef.<span style="color: #004993;">position</span>.Set<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span>GAME_AREA_WIDTH <span style="color: #000000; font-weight: bold;">-</span> wallThickness<span style="color: #000000;">)</span>, </span>
<span style="vertical-align: top;">                                               p2m<span style="color: #000000;">(</span>GAME_AREA_HEIGHT <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  wallBody = ourWorld.CreateBody<span style="color: #000000;">(</span>wallBodyDef<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  wallBody.CreateFixture2<span style="color: #000000;">(</span>wallShape<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// Top / bottom wall shape</span></span>
<span style="vertical-align: top;">  wallShape.SetAsBox<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span>wallWidth <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span>wallThickness <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// top </span></span>
<span style="vertical-align: top;">  wallBodyDef.<span style="color: #004993;">position</span>.Set<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span>GAME_AREA_WIDTH <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span>wallThickness<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  wallBody = ourWorld.CreateBody<span style="color: #000000;">(</span>wallBodyDef<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  wallBody.CreateFixture2<span style="color: #000000;">(</span>wallShape<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// bottom</span></span>
<span style="vertical-align: top;">  wallBodyDef.<span style="color: #004993;">position</span>.Set<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span>GAME_AREA_WIDTH <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, </span>
<span style="vertical-align: top;">                                    p2m<span style="color: #000000;">(</span>GAME_AREA_HEIGHT <span style="color: #000000; font-weight: bold;">-</span> wallThickness<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  wallBody = ourWorld.CreateBody<span style="color: #000000;">(</span>wallBodyDef<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  wallBody.CreateFixture2<span style="color: #000000;">(</span>wallShape<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">Do you see a pattern here? To create a body you need a body definition. You create a shape and a fixture and plug it in to a body. And to create body you use the world object.</p>
<p style="text-align: justify;">Important note: Do not instantiate bodies and joints with the 'new' operator though. By using the world object, you let Box2d manage them and utilise memory when they are destroyed.</p>
<p style="text-align: justify;">So this is how our world looks like. Just four walls around the stage.</p>
<p style="text-align: center;"><object data="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_1_walls.swf" type="application/x-shockwave-flash" width="500" height="480"><param name="src" value="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_1_walls.swf" /><param name="play" value="false" /><param name="wmode" value="window" />
</object></p>
<p>&nbsp;</p>
<h3>Creating dynamic objects</h3>
<p style="text-align: justify;">Now once we have four walls surrounding our world, let's create some dynamic bodies, let it be some boxes that will be dropped from the middle of our stage. The make it easier let's create function 'createBox' that will take x, y, width, height. In addition
    let's add few more properties like isDynamic so we could use this function to create static bodies as well, density, friction, fixedRotation and name string. Function will return a body object that we may keep for a reference if required.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> <span style="color: #004993;">createBox</span><span style="color: #000000;">(</span><span style="color: #004993;">x</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, <span style="color: #004993;">y</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, </span>
<span style="vertical-align: top;">                           <span style="color: #004993;">width</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, <span style="color: #004993;">height</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, </span>
<span style="vertical-align: top;">                           isDynamic<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Boolean</span></a>, </span>
<span style="vertical-align: top;">                           density<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">1</span>, friction<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = .5, </span>
<span style="vertical-align: top;">                           fixedRotation<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Boolean</span></a> = <span style="color: #0033ff; font-weight: bold;">false</span>,</span>
<span style="vertical-align: top;">                           <span style="color: #004993;">name</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">String</span></a> = <span style="color: #990000;">""</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span>b2Body</span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> bWidth<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = p2m<span style="color: #000000;">(</span><span style="color: #004993;">width</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> bHeight<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = p2m<span style="color: #000000;">(</span><span style="color: #004993;">height</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// box shape</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> shape<span style="color: #000000; font-weight: bold;">:</span>b2PolygonShape = <span style="color: #0033ff; font-weight: bold;">new</span> b2PolygonShape<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  shape.SetAsBox<span style="color: #000000;">(</span>bWidth <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>, bHeight <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// fixture</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> fixture<span style="color: #000000; font-weight: bold;">:</span>b2FixtureDef = <span style="color: #0033ff; font-weight: bold;">new</span> b2FixtureDef<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  fixture.density = density;</span>
<span style="vertical-align: top;">  fixture.friction = friction;</span>
<span style="vertical-align: top;">  fixture.shape = shape;</span>
<span style="vertical-align: top;">  fixture.userData = <span style="color: #0033ff; font-weight: bold;">new</span> UserDataInfo<span style="color: #000000;">(</span><span style="color: #004993;">name</span>, bWidth, bHeight<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// body definition</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> bodyDef<span style="color: #000000; font-weight: bold;">:</span>b2BodyDef = <span style="color: #0033ff; font-weight: bold;">new</span> b2BodyDef<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  bodyDef.<span style="color: #004993;">position</span>.Set<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #004993;">x</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> bWidth <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>, p2m<span style="color: #000000;">(</span><span style="color: #004993;">y</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> bHeight <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  bodyDef.<span style="color: #004993;">type</span> = isDynamic <span style="color: #000000; font-weight: bold;">?</span> b2Body.b2_dynamicBody <span style="color: #000000; font-weight: bold;">:</span> b2Body.b2_staticBody;</span>
<span style="vertical-align: top;">  bodyDef.fixedRotation = fixedRotation;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// body</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> body<span style="color: #000000; font-weight: bold;">:</span>b2Body = ourWorld.CreateBody<span style="color: #000000;">(</span>bodyDef<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  body.CreateFixture<span style="color: #000000;">(</span>fixture<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">return</span> body;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p>First we convert width and height from pixels to Box2D units - meters.</p>
<p style="text-align: justify;">Next we create a shape. As this is going to be a box, as when we created our walls, we use the b2PolygonShape class again. Polygons could be created with one of the following methods available in the definition of the class:</p>
<ul>
    <li><strong>SetAsBox </strong>- takes just half width and height of a box and positions it in the center</li>
    <li><strong>SetAsOrientedBox </strong>- allows also setting position of a box</li>
    <li><strong>SetAsArray </strong>- takes a list of vertices to create more complex polygons</li>
</ul>
<p style="text-align: justify;">It is always a good idea to go through the Box2D classes and review their methods as documentation may not be up to date, especially when there is a new release.</p>
<p style="text-align: justify;">The next part of code is actually the only new thing here - the fixture definition. When creating the static walls we used a shortcut and fixtures were created automatically for us. Now we want to be more specific and we aren't going to use defaults,
    so we create one and attach our shape to it among other details like density, friction and userData object.</p>
<p>Just to say a little more about friction properties:</p>
<ul>
    <li><strong>Friction </strong>makes objects slide along each other realistically. The parameter is usually between 0 and 1. A value of zero turns off friction and a value of one makes the friction strong. The friction is computed between two shapes with
        the following formula: Math.sqrt(shape1.friction * shape2.friction).</li>
    <li><strong>Restitution </strong>makes objects bounce and its value is usually set between 0 and 1. A value of zero means an object won't bounce. This is called an inelastic collision. A value of one means that an object's velocity will be exactly reflected.
        This is called a perfectly elastic collision. Restitution is combined using the following formula: Math.Max(shape1.restitution, shape2.restitution).</li>
    <li><strong>UserData </strong>allows to point to a custom object. You don't have to use it if you don't need to track your object down.</li>
    <li><strong>Shape</strong> is used to connect a shape object.</li>
</ul>
<p style="text-align: justify;">Next we create a body definition and specify its position and type: dynamic or static. We can also specify if it's going to rotate or not. Once definition is created, we use the world object to create a new body and using that body we can plug a fixture
    from our fixture definition.</p>
<p style="text-align: justify;">For the userData part of the fixture we could use just a string, number or we could create a custom object. To keep consistency, we will create a class UserDataInfo that will hold width, height and object's name. We will use these information when working
    on collisions later on.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #9900cc; font-weight: bold;">class</span> UserDataInfo</span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">public</span> <span style="color: #6699cc; font-weight: bold;">var</span> <span style="color: #004993;">name</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">String</span></a>;</span>
<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">public</span> <span style="color: #6699cc; font-weight: bold;">var</span> <span style="color: #004993;">width</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, <span style="color: #004993;">height</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>;</span>

<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">public</span> <span style="color: #339966; font-weight: bold;">function</span> UserDataInfo<span style="color: #000000;">(</span><span style="color: #004993;">name</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">String</span></a> = <span style="color: #990000;">""</span>, </span>
<span style="vertical-align: top;">                               <span style="color: #004993;">width</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">0</span>, <span style="color: #004993;">height</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">0</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;">  <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">this</span>.<span style="color: #004993;">name</span> = <span style="color: #004993;">name</span>;</span>
<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">this</span>.<span style="color: #004993;">width</span> = <span style="color: #004993;">width</span>;</span>
<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">this</span>.<span style="color: #004993;">height</span> = <span style="color: #004993;">height</span>;</span>
<span style="vertical-align: top;">  <span style="color: #000000;">}</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">Now when we have our box creation function in place, let's create one static body - a platform in the middle of a stage and few dynamic boxes with random size and position.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> createWorldObjects<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> i<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=int%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:int.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">int</span></a>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// Create platfroms - static boxes</span></span>
<span style="vertical-align: top;">  <span style="color: #004993;">createBox</span><span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">10</span>, GAME_AREA_HEIGHT <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>, GAME_AREA_WIDTH <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">3</span>, </span>
<span style="vertical-align: top;">                            <span style="color: #000000; font-weight: bold;">10</span>, <span style="color: #0033ff; font-weight: bold;">false</span>, <span style="color: #000000; font-weight: bold;">1</span>, .5, <span style="color: #0033ff; font-weight: bold;">false</span>, <span style="color: #990000;">"platform"</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// Create some random dynamic boxes</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> offsetX<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">40</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> offsetTopY<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">20</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> offsetBottomY<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = GAME_AREA_HEIGHT <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> maxWidthHeight<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">20</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> rX<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, rY<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, rWidth<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, rHeight<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> fixedRotation<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Boolean</span></a>;</span>

<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">for</span> <span style="color: #000000;">(</span>i = <span style="color: #000000; font-weight: bold;">0</span>; i <span style="color: #000000; font-weight: bold;">&lt;</span> <span style="color: #000000; font-weight: bold;">10</span>; i<span style="color: #000000; font-weight: bold;">++</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;">  <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">    rX = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> <span style="color: #000000;">(</span>GAME_AREA_WIDTH <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000; font-weight: bold;">2</span> <span style="color: #000000; font-weight: bold;">*</span> offsetX<span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> offsetX;</span>
<span style="vertical-align: top;">    rY = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> </span>
<span style="vertical-align: top;">            <span style="color: #000000;">(</span>GAME_AREA_HEIGHT <span style="color: #000000; font-weight: bold;">-</span> offsetBottomY <span style="color: #000000; font-weight: bold;">-</span> offsetTopY<span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> offsetTopY;</span>
<span style="vertical-align: top;">    rWidth = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> maxWidthHeight <span style="color: #000000; font-weight: bold;">+</span> <span style="color: #000000; font-weight: bold;">10</span>;</span>
<span style="vertical-align: top;">    rHeight = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> maxWidthHeight <span style="color: #000000; font-weight: bold;">+</span> <span style="color: #000000; font-weight: bold;">10</span>;</span>
<span style="vertical-align: top;">    fixedRotation = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">&gt;</span>= .5;</span>

<span style="vertical-align: top;">    <span style="color: #004993;">createBox</span><span style="color: #000000;">(</span>rX, rY, rWidth, rHeight, <span style="color: #0033ff; font-weight: bold;">true</span>, <span style="color: #000000; font-weight: bold;">1</span>, .5, </span>
<span style="vertical-align: top;">                                               fixedRotation, <span style="color: #990000;">"box"</span> <span style="color: #000000; font-weight: bold;">+</span> i<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #000000;">}</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">We aren't limited just to boxes, we can provide a list of vertices ourselves and create other type of polygons - triangles. Let's create some triangles with a function very similar to the createBox. There is one important thing to note quoting the Box2D
    manual: "When you build a polygon definition you must specify the number of vertices you will use. The vertices must be specified in counter-clockwise (CCW) order about the z-axis of a right-handed coordinate system. This might turn out to be clockwise
    on your screen, depending on your coordinate system conventions". In practise if you are not sure what's your coordinate system, you can always try both ways, an indication that the order is incorrect would be that your polygons will not properly
    collide with other objects (fall through them). The same thing may happen if a polygon is not convex, <span style="background-color: #ffffff; color: #333333; font-family: tahoma, verdana, sans-serif; font-size: 12px; line-height: 18.233333587646484px;">each vertex must point outwards to some degree. Vertices can't overlap as well</span>.
    For our triangles below the vertices are provided in clockwise order.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> createTriangle<span style="color: #000000;">(</span><span style="color: #004993;">x</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, <span style="color: #004993;">y</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, </span>
<span style="vertical-align: top;">                                <span style="color: #004993;">width</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, <span style="color: #004993;">height</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, </span>
<span style="vertical-align: top;">                                isDynamic<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Boolean</span></a>, </span>
<span style="vertical-align: top;">                                density<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">1</span>, friction<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = .5, </span>
<span style="vertical-align: top;">                                fixedRotation<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Boolean</span></a> = <span style="color: #0033ff; font-weight: bold;">false</span>, </span>
<span style="vertical-align: top;">                                <span style="color: #004993;">name</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">String</span></a> = <span style="color: #990000;">""</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span>b2Body</span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> bWidth<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = p2m<span style="color: #000000;">(</span><span style="color: #004993;">width</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> bHeight<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = p2m<span style="color: #000000;">(</span><span style="color: #004993;">height</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// shape</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> shape<span style="color: #000000; font-weight: bold;">:</span>b2PolygonShape = <span style="color: #0033ff; font-weight: bold;">new</span> b2PolygonShape<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> vertices<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=array%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:array.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Array</span></a> = <span style="color: #000000;">[</span><span style="color: #000000;">]</span>;</span>
<span style="vertical-align: top;">  vertices.<span style="color: #004993;">push</span><span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span>bWidth <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>, bHeight <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;  <span style="color: #009900;">// right bottom</span></span>
<span style="vertical-align: top;">  vertices.<span style="color: #004993;">push</span><span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">-</span>bWidth <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>, bHeight <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>; <span style="color: #009900;">// left bottom</span></span>
<span style="vertical-align: top;">  vertices.<span style="color: #004993;">push</span><span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">0</span>, <span style="color: #000000; font-weight: bold;">-</span>bHeight <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;          <span style="color: #009900;">// middle top</span></span>
<span style="vertical-align: top;">  shape.SetAsArray<span style="color: #000000;">(</span>vertices<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// fixture</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> fixture<span style="color: #000000; font-weight: bold;">:</span>b2FixtureDef = <span style="color: #0033ff; font-weight: bold;">new</span> b2FixtureDef<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  fixture.density = density;</span>
<span style="vertical-align: top;">  fixture.friction = friction;</span>
<span style="vertical-align: top;">  fixture.shape = shape;</span>
<span style="vertical-align: top;">  fixture.userData = <span style="color: #0033ff; font-weight: bold;">new</span> UserDataInfo<span style="color: #000000;">(</span><span style="color: #004993;">name</span>, bWidth, bHeight<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// body definition</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> bodyDef<span style="color: #000000; font-weight: bold;">:</span>b2BodyDef = <span style="color: #0033ff; font-weight: bold;">new</span> b2BodyDef<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  bodyDef.<span style="color: #004993;">position</span>.Set<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #004993;">x</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> bWidth <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>, p2m<span style="color: #000000;">(</span><span style="color: #004993;">y</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> bHeight <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  bodyDef.<span style="color: #004993;">type</span> = isDynamic <span style="color: #000000; font-weight: bold;">?</span> </span>
<span style="vertical-align: top;">                          b2Body.b2_dynamicBody <span style="color: #000000; font-weight: bold;">:</span> b2Body.b2_staticBody;</span>
<span style="vertical-align: top;">  bodyDef.fixedRotation = fixedRotation;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// body</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> body<span style="color: #000000; font-weight: bold;">:</span>b2Body = ourWorld.CreateBody<span style="color: #000000;">(</span>bodyDef<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  body.CreateFixture<span style="color: #000000;">(</span>fixture<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">return</span> body;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p>And let's plug triangles to our makeWorldObjects function:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #009900;">// Create some random triangles</span></span>
<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">for</span> <span style="color: #000000;">(</span>i = <span style="color: #000000; font-weight: bold;">0</span>; i <span style="color: #000000; font-weight: bold;">&lt;</span> <span style="color: #000000; font-weight: bold;">10</span>; i<span style="color: #000000; font-weight: bold;">++</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  rX = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> </span>
<span style="vertical-align: top;">                <span style="color: #000000;">(</span>GAME_AREA_WIDTH <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000; font-weight: bold;">2</span> <span style="color: #000000; font-weight: bold;">*</span> offsetX<span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> offsetX;</span>
<span style="vertical-align: top;">  rY = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> </span>
<span style="vertical-align: top;">                <span style="color: #000000;">(</span>GAME_AREA_HEIGHT <span style="color: #000000; font-weight: bold;">-</span> offsetBottomY <span style="color: #000000; font-weight: bold;">-</span> offsetTopY<span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> offsetTopY;</span>
<span style="vertical-align: top;">  rWidth = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> maxWidthHeight <span style="color: #000000; font-weight: bold;">+</span> <span style="color: #000000; font-weight: bold;">10</span>;</span>
<span style="vertical-align: top;">  rHeight = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> maxWidthHeight <span style="color: #000000; font-weight: bold;">+</span> <span style="color: #000000; font-weight: bold;">10</span>;</span>
<span style="vertical-align: top;">  fixedRotation = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">&gt;</span>= .5;</span>

<span style="vertical-align: top;">  createTriangle<span style="color: #000000;">(</span>rX, rY, rWidth, rHeight, <span style="color: #0033ff; font-weight: bold;">true</span>, <span style="color: #000000; font-weight: bold;">1</span>, .5, </span>
<span style="vertical-align: top;">                                              fixedRotation, <span style="color: #990000;">"triangle"</span> <span style="color: #000000; font-weight: bold;">+</span> i<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">We have boxes and triangles so let's add some circles as well. We will create another function createCircle, very similar to createBox and createTriangle but instead of width and height we will pass radius and to create a circular shape we will use b2CircleShape
    object.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> createCircle<span style="color: #000000;">(</span><span style="color: #004993;">x</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, <span style="color: #004993;">y</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, </span>
<span style="vertical-align: top;">                              radius<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, </span>
<span style="vertical-align: top;">                              isDynamic<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Boolean</span></a>, </span>
<span style="vertical-align: top;">                              density<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">1</span>, friction<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = .5, </span>
<span style="vertical-align: top;">                              fixedRotation<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Boolean</span></a> = <span style="color: #0033ff; font-weight: bold;">false</span>, </span>
<span style="vertical-align: top;">                              <span style="color: #004993;">name</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">String</span></a> = <span style="color: #990000;">""</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span>b2Body</span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> bRadius<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = p2m<span style="color: #000000;">(</span>radius<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// circle shape</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> shape<span style="color: #000000; font-weight: bold;">:</span>b2CircleShape = <span style="color: #0033ff; font-weight: bold;">new</span> b2CircleShape<span style="color: #000000;">(</span>bRadius<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// fixture</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> fixture<span style="color: #000000; font-weight: bold;">:</span>b2FixtureDef = <span style="color: #0033ff; font-weight: bold;">new</span> b2FixtureDef<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  fixture.density = density;</span>
<span style="vertical-align: top;">  fixture.friction = friction;</span>
<span style="vertical-align: top;">  fixture.shape = shape;</span>
<span style="vertical-align: top;">  fixture.userData = <span style="color: #0033ff; font-weight: bold;">new</span> UserDataInfo<span style="color: #000000;">(</span><span style="color: #004993;">name</span>, bRadius <span style="color: #000000; font-weight: bold;">*</span> <span style="color: #000000; font-weight: bold;">2</span>, bRadius <span style="color: #000000; font-weight: bold;">*</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// body definition</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> bodyDef<span style="color: #000000; font-weight: bold;">:</span>b2BodyDef = <span style="color: #0033ff; font-weight: bold;">new</span> b2BodyDef<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  bodyDef.<span style="color: #004993;">position</span>.Set<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #004993;">x</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> bRadius <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>, p2m<span style="color: #000000;">(</span><span style="color: #004993;">y</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> bRadius <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  bodyDef.<span style="color: #004993;">type</span> = isDynamic <span style="color: #000000; font-weight: bold;">?</span> </span>
<span style="vertical-align: top;">                         b2Body.b2_dynamicBody <span style="color: #000000; font-weight: bold;">:</span> b2Body.b2_staticBody;</span>
<span style="vertical-align: top;">  bodyDef.fixedRotation = fixedRotation;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// body</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> body<span style="color: #000000; font-weight: bold;">:</span>b2Body = ourWorld.CreateBody<span style="color: #000000;">(</span>bodyDef<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  body.CreateFixture<span style="color: #000000;">(</span>fixture<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">return</span> body;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p>And let's add this code to the makeWorldObjects function:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #009900;">// Create some random circles</span></span>
<span style="vertical-align: top;"><span style="color: #6699cc; font-weight: bold;">var</span> rRadius<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>;</span>
<span style="vertical-align: top;"><span style="color: #6699cc; font-weight: bold;">var</span> maxRadius<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a> = <span style="color: #000000; font-weight: bold;">10</span>;</span>

<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">for</span> <span style="color: #000000;">(</span>i = <span style="color: #000000; font-weight: bold;">0</span>; i <span style="color: #000000; font-weight: bold;">&lt;</span> <span style="color: #000000; font-weight: bold;">10</span>; i<span style="color: #000000; font-weight: bold;">++</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  rX = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> <span style="color: #000000;">(</span>GAME_AREA_WIDTH <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000; font-weight: bold;">2</span> <span style="color: #000000; font-weight: bold;">*</span> offsetX<span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> offsetX;</span>
<span style="vertical-align: top;">  rY = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> </span>
<span style="vertical-align: top;">            <span style="color: #000000;">(</span>GAME_AREA_HEIGHT <span style="color: #000000; font-weight: bold;">-</span> offsetBottomY <span style="color: #000000; font-weight: bold;">-</span> offsetTopY<span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">+</span> offsetTopY;</span>
<span style="vertical-align: top;">  rRadius = <a href="http://www.google.com/search?q=math%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:math.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Math</span></a>.<span style="color: #004993;">random</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">*</span> maxRadius <span style="color: #000000; font-weight: bold;">+</span> <span style="color: #000000; font-weight: bold;">10</span>;</span>
<span style="vertical-align: top;">  fixedRotation = <span style="color: #0033ff; font-weight: bold;">false</span>;</span>

<span style="vertical-align: top;">  createCircle<span style="color: #000000;">(</span>rX, rY, rRadius, <span style="color: #0033ff; font-weight: bold;">true</span>, <span style="color: #000000; font-weight: bold;">1</span>, .5, fixedRotation, <span style="color: #990000;">"circle"</span> <span style="color: #000000; font-weight: bold;">+</span> i<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">Just in a moment we will start applying forces and impulses, but before let's create one more a little bit more complex object, made of different shapes. You can add multiple shapes to one body, remember that bodies are rigid so you nothing can breakthem.
    Additional shapes are not for visual effect, they will form more complex object for collision detection and may change the center of a mass in a body. I we add a very long left hand to a human object, it will move a mass to that side and if that object
    can rotate, it will probably fall on that side.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> createHero<span style="color: #000000;">(</span><span style="color: #004993;">x</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, <span style="color: #004993;">y</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span>b2Body</span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #009900;">// fixture</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> fixture<span style="color: #000000; font-weight: bold;">:</span>b2FixtureDef = <span style="color: #0033ff; font-weight: bold;">new</span> b2FixtureDef<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  fixture.friction = .5;</span>
<span style="vertical-align: top;">  fixture.userData = <span style="color: #0033ff; font-weight: bold;">new</span> UserDataInfo<span style="color: #000000;">(</span><span style="color: #990000;">"hero"</span>, p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">30</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">60</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// body definition</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> bodyDef<span style="color: #000000; font-weight: bold;">:</span>b2BodyDef = <span style="color: #0033ff; font-weight: bold;">new</span> b2BodyDef<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  bodyDef.<span style="color: #004993;">position</span>.Set<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #004993;">x</span> <span style="color: #000000; font-weight: bold;">+</span> <span style="color: #000000; font-weight: bold;">15</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span><span style="color: #004993;">y</span> <span style="color: #000000; font-weight: bold;">+</span> <span style="color: #000000; font-weight: bold;">30</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  bodyDef.<span style="color: #004993;">type</span> = b2Body.b2_dynamicBody;</span>
<span style="vertical-align: top;">  bodyDef.fixedRotation = <span style="color: #0033ff; font-weight: bold;">true</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// body</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> body<span style="color: #000000; font-weight: bold;">:</span>b2Body = ourWorld.CreateBody<span style="color: #000000;">(</span>bodyDef<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// shapes</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> headShape<span style="color: #000000; font-weight: bold;">:</span>b2CircleShape = <span style="color: #0033ff; font-weight: bold;">new</span> b2CircleShape<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">10</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  headShape.b2internal<span style="color: #000000; font-weight: bold;">::</span>m_p.Set<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">0</span>, p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">20</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  fixture.shape = headShape;</span>
<span style="vertical-align: top;">  body.CreateFixture<span style="color: #000000;">(</span>fixture<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> boxShape<span style="color: #000000; font-weight: bold;">:</span>b2PolygonShape = <span style="color: #0033ff; font-weight: bold;">new</span> b2PolygonShape<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  boxShape.SetAsBox<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">15</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">10</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  fixture.shape = boxShape;</span>
<span style="vertical-align: top;">  body.CreateFixture<span style="color: #000000;">(</span>fixture<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> leftLegShape<span style="color: #000000; font-weight: bold;">:</span>b2PolygonShape = <span style="color: #0033ff; font-weight: bold;">new</span> b2PolygonShape<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  leftLegShape.SetAsArray<span style="color: #000000;">(</span></span>
<span style="vertical-align: top;">    <span style="color: #000000;">[</span></span>
<span style="vertical-align: top;">      <span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">30</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">20</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>,  <span style="color: #009900;">// right top</span></span>
<span style="vertical-align: top;">      <span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">20</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">60</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>,  <span style="color: #009900;">// right bottom</span></span>
<span style="vertical-align: top;">      <span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">20</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">60</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>, <span style="color: #009900;">// left bottom</span></span>
<span style="vertical-align: top;">      <span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span>p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">30</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, p2m<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">20</span> <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>  <span style="color: #009900;">// left top</span></span>
<span style="vertical-align: top;">    <span style="color: #000000;">]</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  fixture.shape = leftLegShape;</span>
<span style="vertical-align: top;">  body.CreateFixture<span style="color: #000000;">(</span>fixture<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">return</span> body;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p>Now let's create global variable hero and create hero in createWorldObjects function:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;">hero = createHero<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">40</span>, <span style="color: #000000; font-weight: bold;">20</span><span style="color: #000000;">)</span>;</span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p>To tell the truth, most of the simple games based on Box2D have hero which is just a simple box shape and a bitmap representing it has a shape of human, robot or whatever the hero might be. But there are also games that have really very complex structures
    like cross country cars or even tanks made of many objects.</p>
<p>This is the current state of our project. Notice how objects change their colors to gray just after few seconds from the start of the simulation, this indicates that they are sleeping. Do you remember the doSleep parameter when creating the world object
    - we allowed bodies to sleep? This means that every time a body becomes inactive - it's velocity is zero and is not colliding with other body that has some velocity, it will be removed from the simulation what will improve the performance. But if
    a body is in the sleep mode it doesn't mean it can't be woken up. You can check if body is sleeping with IsSleeping and you can wake it up with WakeUp, both are methods of the body object. Body will also be woken up if there is a collision or a force
    applied to it.</p>
<p style="text-align: center;"><object data="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_2_more_objects.swf" type="application/x-shockwave-flash" width="500" height="480"><param name="src" value="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_2_more_objects.swf" /><param name="play" value="false" /><param name="loop" value="false" /><param name="wmode" value="window" />
</object></p>
<h2><br />Using forces to control objects</h2>
<p style="text-align: justify;">You can apply forces, torques, and impulses to a body. When applying a force or an impulse, you need to provide a world point coordination where the load is going to be applied. Let's test this on our hero and add some way of controlling him using keyboard.</p>
<p style="text-align: justify;">First we need to add a way to find out what keys are pressed by a user. We will create a global array keysDown that will hold all keys that are currently down (pressed) and then add necessary listeners to our init function. We will also create listener
    handlers that will mark what keys are currently down and a little helper function returning boolean to check what key is currently pressed.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #6699cc; font-weight: bold;">var</span> keysDown<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=array%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:array.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Array</span></a>;</span>

<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> <span style="color: #004993;">init</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span><span style="color: #004993;">hasEventListener</span><span style="color: #000000;">(</span><a href="http://www.google.com/search?q=event%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:event.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Event</span></a>.<span style="color: #004993;">ADDED_TO_STAGE</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> </span>
<span style="vertical-align: top;">    <span style="color: #004993;">removeEventListener</span><span style="color: #000000;">(</span><a href="http://www.google.com/search?q=event%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:event.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Event</span></a>.<span style="color: #004993;">ADDED_TO_STAGE</span>, <span style="color: #004993;">init</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  initDebugUI<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  createWorld<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  initDebugDraw<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  createWorldWalls<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  createWorldObjects<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #004993;">addEventListener</span><span style="color: #000000;">(</span><a href="http://www.google.com/search?q=event%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:event.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Event</span></a>.<span style="color: #004993;">ENTER_FRAME</span>, updatePhysics<span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  keysDown = <span style="color: #000000;">[</span><span style="color: #000000;">]</span>;</span>
<span style="vertical-align: top;">  <span style="color: #004993;">stage</span>.<span style="color: #004993;">addEventListener</span><span style="color: #000000;">(</span><a href="http://www.google.com/search?q=keyboardevent%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:keyboardevent.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">KeyboardEvent</span></a>.<span style="color: #004993;">KEY_DOWN</span>, onKeyDown<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">  <span style="color: #004993;">stage</span>.<span style="color: #004993;">addEventListener</span><span style="color: #000000;">(</span><a href="http://www.google.com/search?q=keyboardevent%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:keyboardevent.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">KeyboardEvent</span></a>.<span style="color: #004993;">KEY_UP</span>, onKeyUp<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span>

<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">protected</span> <span style="color: #339966; font-weight: bold;">function</span> onKeyDown<span style="color: #000000;">(</span>e<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=keyboardevent%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:keyboardevent.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">KeyboardEvent</span></a><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  keysDown<span style="color: #000000;">[</span>e.<span style="color: #004993;">keyCode</span><span style="color: #000000;">]</span> = <span style="color: #0033ff; font-weight: bold;">true</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span>

<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">protected</span> <span style="color: #339966; font-weight: bold;">function</span> onKeyUp<span style="color: #000000;">(</span>e<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=keyboardevent%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:keyboardevent.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">KeyboardEvent</span></a><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  keysDown<span style="color: #000000;">[</span>e.<span style="color: #004993;">keyCode</span><span style="color: #000000;">]</span> = <span style="color: #0033ff; font-weight: bold;">false</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span>

<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">public</span> <span style="color: #339966; font-weight: bold;">function</span> isKeyDown<span style="color: #000000;">(</span><span style="color: #004993;">keyCode</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=int%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:int.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">int</span></a><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=boolean%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:boolean.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Boolean</span></a></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">return</span> keysDown<span style="color: #000000;">[</span><span style="color: #004993;">keyCode</span><span style="color: #000000;">]</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p>Next let's two constants limiting hero's speed on x and y axis.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> const heroSpeedX<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>  = <span style="color: #000000; font-weight: bold;">2</span>;</span>
<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> const heroSpeedY<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>  = <span style="color: #000000; font-weight: bold;">50</span>;</span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p>At the beginning of our updatePhysics function add these lines:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>isKeyDown<span style="color: #000000;">(</span><a href="http://www.google.com/search?q=keyboard%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:keyboard.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Keyboard</span></a>.<span style="color: #004993;">LEFT</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">&amp;&amp;</span> hero.GetLinearVelocity<span style="color: #000000;">(</span><span style="color: #000000;">)</span>.<span style="color: #004993;">x</span> <span style="color: #000000; font-weight: bold;">&gt;</span> <span style="color: #000000; font-weight: bold;">-</span>heroSpeedX<span style="color: #000000;">)</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  hero.ApplyImpulse<span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">-</span>heroSpeedX <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>, <span style="color: #000000; font-weight: bold;">0</span><span style="color: #000000;">)</span>, hero.GetWorldCenter<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span>

<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>isKeyDown<span style="color: #000000;">(</span><a href="http://www.google.com/search?q=keyboard%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:keyboard.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Keyboard</span></a>.<span style="color: #004993;">RIGHT</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">&amp;&amp;</span> hero.GetLinearVelocity<span style="color: #000000;">(</span><span style="color: #000000;">)</span>.<span style="color: #004993;">x</span> <span style="color: #000000; font-weight: bold;">&lt;</span> heroSpeedX<span style="color: #000000;">)</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  hero.ApplyImpulse<span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span>heroSpeedX <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span>, <span style="color: #000000; font-weight: bold;">0</span><span style="color: #000000;">)</span>, hero.GetWorldCenter<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span>

<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>isKeyDown<span style="color: #000000;">(</span><a href="http://www.google.com/search?q=keyboard%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:keyboard.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Keyboard</span></a>.<span style="color: #004993;">UP</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  hero.ApplyForce<span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">0</span>, <span style="color: #000000; font-weight: bold;">-</span>heroSpeedY <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, hero.GetWorldCenter<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">What we are doing is we are checking if LEFT, RIGHT or UP button was pressed and in case of left and right we are also checking if the current hero's linear velocity is not greater than our limit in heroSpeedX as we don't want him to speed up out of control.
    If these conditions are met we apply impulse with power equal to hero's max speed to the center of our hero object using GetWorldCenter method. If we applied force to some other point than the center, the hero object would rotate (actually it wouldn't
    in our case as the body definition had fixedRotation parameter set to true).</p>
<p style="text-align: center;"><object data="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_3_flying_hero.swf" type="application/x-shockwave-flash" width="500" height="480"><param name="src" value="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_3_flying_hero.swf" /><param name="play" value="false" /><param name="loop" value="false" /><param name="wmode" value="window" />
</object></p>
<p>&nbsp;</p>
<p style="text-align: justify;">There are three popular ways of having an interaction with objects in Box2D, all of them are methods of a body object (as they are applied to a body object):</p>
<ul>
    <li>applying impulse with ApplyImpulse</li>
    <li>applying force with ApplyForce</li>
    <li>setting linear velocity with SetLinearVelocity</li>
</ul>
<p style="text-align: justify;">&nbsp;</p>
<p style="text-align: justify;">Box2D documentation doesn't say much about differences but just by playing with it you can see the difference.</p>
<p style="text-align: justify;">Try to change the heroSpeedY and the type of force applied:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #009900;">// inside update:</span></span>
<span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>isKeyDown<span style="color: #000000;">(</span><a href="http://www.google.com/search?q=keyboard%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:keyboard.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Keyboard</span></a>.<span style="color: #004993;">UP</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #009900;">// for heroSpeedY = 1</span></span>
<span style="vertical-align: top;">  <span style="color: #009900;">//hero.ApplyImpulse(new b2Vec2(0, -heroSpeedY / 2), hero.GetWorldCenter());</span></span>

<span style="vertical-align: top;">  <span style="color: #009900;">// for heroSpeedY = 50</span></span>
<span style="vertical-align: top;">  hero.ApplyForce<span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">0</span>, <span style="color: #000000; font-weight: bold;">-</span>heroSpeedY <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, hero.GetWorldCenter<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// for heroSpeedY = 10</span></span>
<span style="vertical-align: top;">  <span style="color: #009900;">//hero.SetLinearVelocity(new b2Vec2(hero.GetLinearVelocity().x, -heroSpeedY / 2));</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">What you should notice is that the longer you keep the UP key down the more acceleration the hero gets, it means that the impulses or forces are added on top of the current speed. But applying the linear velocity doesn't do that, it only sets that speed
    and the hero never goes above that. Also notice that we apply different values to force and impulse to get the same hero's actual speed.</p>
<p style="text-align: justify;">But what if we wanted to make our hero jumping instead of flying, like in platformer games?</p>
<p>&nbsp;</p>
<h2>Collisions - using contacts</h2>
<p style="text-align: justify;">We will start with a little bit of theory first. The most important thing to remember is that Box2D uses shapes (or rather fixtures containing shapes) for collision detection. Information about collisions is available in contacts which are objects of
    type b2Contact. We can get them either from a world object or specific body. In our case it makes sense to check collisions for the hero object. Contact objects contain pointers to two fixtures that are colliding with each other as well as other information.
    Contact objects are immediately created by Box2D when bounding boxes of two objects are colliding (this is called AABB - axis-aligned bounding box collision). Of course for circular or more complex polygonal object we want more precise detection than
    that, but no worries, contacts have IsTouching method that allows to check if the collision is actually happening.</p>
<p style="text-align: justify;">We want our hero to jump only when he touches (stands on) a ground or other objects. Let's create a new global boolean variable canHeroJump and a function updateHeroCollision that will set canHeroJump to true or false depending on whether the hero touches
    anything.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">private</span> <span style="color: #339966; font-weight: bold;">function</span> updateHeroCollisions<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> manifold<span style="color: #000000; font-weight: bold;">:</span>b2WorldManifold;</span>
<span style="vertical-align: top;">  <span style="color: #6699cc; font-weight: bold;">var</span> collisionNormal<span style="color: #000000; font-weight: bold;">:</span>b2Vec2 = <span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">  canHeroJump = <span style="color: #0033ff; font-weight: bold;">false</span>;</span>

<span style="vertical-align: top;">  <span style="color: #009900;">// Iterate through contact lists - all collisions that hero currently have</span></span>
<span style="vertical-align: top;">  <span style="color: #0033ff; font-weight: bold;">for</span> <span style="color: #000000;">(</span><span style="color: #6699cc; font-weight: bold;">var</span> edge<span style="color: #000000; font-weight: bold;">:</span>b2ContactEdge = hero.GetContactList<span style="color: #000000;">(</span><span style="color: #000000;">)</span>; edge; edge = edge.next<span style="color: #000000;">)</span></span>
<span style="vertical-align: top;">  <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">    manifold = <span style="color: #0033ff; font-weight: bold;">new</span> b2WorldManifold<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">    edge.contact.GetWorldManifold<span style="color: #000000;">(</span>manifold<span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">    collisionNormal = manifold.m_normal;</span>

<span style="vertical-align: top;">    <span style="color: #009900;">// We still don't know whether our hero is fixtureA or fixtureB</span></span>
<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> fixtureA<span style="color: #000000; font-weight: bold;">:</span>b2Fixture = edge.contact.GetFixtureA<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> fixtureB<span style="color: #000000; font-weight: bold;">:</span>b2Fixture = edge.contact.GetFixtureB<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> nameA<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">String</span></a> = fixtureA.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">?</span> </span>
<span style="vertical-align: top;">                      <span style="color: #000000;">(</span>fixtureA.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">as</span> UserDataInfo<span style="color: #000000;">)</span>.<span style="color: #004993;">name</span> <span style="color: #000000; font-weight: bold;">:</span> <span style="color: #990000;">"wall"</span>;</span>
<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> nameB<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">String</span></a> = fixtureB.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">?</span> </span>
<span style="vertical-align: top;">                      <span style="color: #000000;">(</span>fixtureB.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">as</span> UserDataInfo<span style="color: #000000;">)</span>.<span style="color: #004993;">name</span> <span style="color: #000000; font-weight: bold;">:</span> <span style="color: #990000;">"wall"</span>;</span>

<span style="vertical-align: top;">    <span style="color: #009900;">// If hero is in fixtureB than the normal is calculated from the colliding </span></span>
<span style="vertical-align: top;">    <span style="color: #009900;">// object's point of view so to have consistent normals for hero in </span></span>
<span style="vertical-align: top;">    <span style="color: #009900;">// fixture A and B, we multiply it by minus one.</span></span>
<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>nameB == <span style="color: #990000;">"hero"</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;">    <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">      collisionNormal.<span style="color: #004993;">x</span> <span style="color: #000000; font-weight: bold;">*</span>= <span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">1</span>;</span>
<span style="vertical-align: top;">      collisionNormal.<span style="color: #004993;">y</span> <span style="color: #000000; font-weight: bold;">*</span>= <span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">1</span>;</span>
<span style="vertical-align: top;">    <span style="color: #000000;">}</span></span>

<span style="vertical-align: top;">    <span style="color: #009900;">// If we got here it means there is a bounding box collision (AABB).</span></span>
<span style="vertical-align: top;">    <span style="color: #009900;">// To make sure that shapes are colliding we use IsTouching method.</span></span>
<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>edge.contact.IsTouching<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;">    <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">      <span style="color: #009900;">// If the normal vertical value is greater than zero it means that some </span></span>
<span style="vertical-align: top;">      <span style="color: #009900;">// object is pushing the hero up. In other words, the hero is standing </span></span>
<span style="vertical-align: top;">      <span style="color: #009900;">// in something.</span></span>
<span style="vertical-align: top;">      <span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>collisionNormal.<span style="color: #004993;">y</span> <span style="color: #000000; font-weight: bold;">&gt;</span> <span style="color: #000000; font-weight: bold;">0</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;">      <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">        canHeroJump = <span style="color: #0033ff; font-weight: bold;">true</span>;</span>
<span style="vertical-align: top;">      <span style="color: #000000;">}</span></span>

<span style="vertical-align: top;">      heroNormal = collisionNormal;</span>
<span style="vertical-align: top;">    <span style="color: #000000;">}</span></span>
<span style="vertical-align: top;">  <span style="color: #000000;">}</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">What we are doing is iterating through a contacts list that we get from our hero body object. Each contact object (or ContactEdge) has a pointer to the next one. Why is it called ContactEdge? Well this is a graph structure where edges (lines in a graph)
    represent contacts and nodes (circles in a graph) are colliding objects. Graphically it looks like on a picture below.</p>
<p style="text-align: center;"><img src="http://sierakowski.eu/examples/box2d_part1/Box2DCollisionGraph.jpg" alt="Box2d Collision Graph" /></p>
<p style="text-align: justify;">You can see how easy it is to read it, the object C collides with the object A and B and on the graph there are two edges linking these three objects from the object C point of view. So each edge has two ends - linking to two objects (nodes) - actually
    fixtures and you can get them using GetFixtureA and GetFixtureB methods.</p>
<p style="text-align: justify;">Ok, so once we have our edge contact, we create a manifold object and populate it using GetWorldManifold method of the contact object. What the hell is that manifold? Well, each contact stores location of the collision points in local coordinates which
    is not very useful to us, but we can get global collision points coordinates using these world manifolds. Why do we need point coordinates? This will be used to get collision normals that are very useful and we will see that just in a minute.</p>
<p style="text-align: justify;">So having pointers to our colliding objects (actually their fixtures!), we can check their names using GetUserData. We need to always check which fixture belongs to our hero as this is not guaranteed that FixtureA will always point to the body that we
    took the contacts from.</p>
<p style="text-align: justify;">As I mentioned before, these fixtures may not be actually colliding, their bounding boxes are but no their circular shapes. This is why we are using IsTouching method that returns true if the shapes are overlapping. In this place we want to set our heroCanJump
    boolean as well.</p>
<p style="text-align: justify;">To make it easier to understand difference between collision of AABB and collision of fixtures I created two text fields printing all obstacles our hero is colliding with. I also added two new static objects - the circles, move the hero down under them
    and you will see that even if he is not touching the second circle from the left, it shows up on as a AABB collision. To get a visual reference of bounding boxes around objects, click on the aabbBit button at the top.</p>
<p style="text-align: justify;">You may wonder why the hero standing on or touching one object is sometimes detected twice. Actually the hero object is made of three shapes (fixtures), head, waist and legs and if at any time two or more of them are touching something, the collision
    is detected for each of them separately.</p>
<p style="text-align: justify;">In addition to know if our hero is touching something, we also want to know if actually he is standing on something. We don't want him to jump if he is in the air already and touches left or right side walls (although some platformers actually do that),
    we want him to stand on something to jump. This is where we use normals from the manifold object mentioned before. Even if an colliding object has two contact points, both points have the same normal, pointing from fixtureA on fixtureB as on the illustration
    (from the Box2D manual) below:</p>
<p style="text-align: center;"><img src="http://sierakowski.eu/examples/box2d_part1/normals.jpg" alt="Normals" /></p>
<p style="text-align: justify;">So if our hero is standing on something the y part of the normal should be +1, if there is something pressing him it should be -1. This is true if hero is our fixtureA. If other object colliding with the hero is fixtureA and the hero is fixtureB we need
    to mutliply the normal by -1.</p>
<p style="text-align: justify;">So this is why we added a check to determine which fixture is our hero and convert normal if needed.</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>nameB == <span style="color: #990000;">"hero"</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  collisionNormal.<span style="color: #004993;">x</span> <span style="color: #000000; font-weight: bold;">*</span>= <span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">1</span>;</span>
<span style="vertical-align: top;">  collisionNormal.<span style="color: #004993;">y</span> <span style="color: #000000; font-weight: bold;">*</span>= <span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">1</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p>Inside the isTouching if clause we check the normal's y part and set canHeroJump variable:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>collisionNormal.<span style="color: #004993;">y</span> <span style="color: #000000; font-weight: bold;">&gt;</span> <span style="color: #000000; font-weight: bold;">0</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  canHeroJump = <span style="color: #0033ff; font-weight: bold;">true</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p>Then in the updatePhysics function let's modify the condition for applying impulse to make the hero jump:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>isKeyDown<span style="color: #000000;">(</span><a href="http://www.google.com/search?q=keyboard%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:keyboard.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Keyboard</span></a>.<span style="color: #004993;">UP</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">&amp;&amp;</span> canHeroJump<span style="color: #000000;">)</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  hero.ApplyImpulse<span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">new</span> b2Vec2<span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">0</span>, <span style="color: #000000; font-weight: bold;">-</span>heroSpeedY <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span>, hero.GetWorldCenter<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">Now the impulse will be applied only once, so it won't add new value on top of the current one as before. For this reason we need to increase the maxSpeedY value to 20. And here is the result: (in the text fields I also print the normal value of the collision
    contact so you can read where is the obstacle colliding with the hero located).</p>
<p style="text-align: center;"><object data="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_4_jumping_hero_collision.swf" type="application/x-shockwave-flash" width="500" height="480"><param name="src" value="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_4_jumping_hero_collision.swf" /><param name="play" value="false" /><param name="loop" value="false" /><param name="wmode" value="window" />
</object></p>
<p style="text-align: justify;">So our simulation looks little more like platformer, the hero only jumps when there is some piece of ground under his legs. But try to jump to the left or right wall pressing the LEFT or RIGHT key, you will notice that the hero stick to it. We don't want
    that. But we can help it again using our normals, this time the x component of it. If during collision we detect that x has negative value it would mean that the hero is pressing against the left wall, if normal has positive value, the hero presses
    the right wall. Let's create another global variable called heroNormal, set it equal to collisionNormal only if there is a touch collision and use it as the additional condition when controlling the hero's left and right movements in the update function.
    You can see it in the final code and here is a result:</p>
<p style="text-align: center;"><object data="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_5_jumping_hero_collision2.swf" type="application/x-shockwave-flash" width="500" height="480"><param name="src" value="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_5_jumping_hero_collision2.swf" /><param name="play" value="false" /><param name="wmode" value="window" />
</object></p>
<p>&nbsp;</p>
<h3>Creating one-sided platfroms with custom contact listeners</h3>
<p style="text-align: justify;">To make the game a little bit more like a platformer, let's create one more platform and make it one sided, so the hero could jump on it through it.</p>
<p style="text-align: justify;">Add this line to the createWorldObjects function:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #004993;">createBox</span><span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">120</span>, GAME_HEIGHT <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000; font-weight: bold;">125</span>, GAME_WIDTH <span style="color: #000000; font-weight: bold;">-</span> <span style="color: #000000; font-weight: bold;">250</span>, <span style="color: #000000; font-weight: bold;">10</span>, </span>
<span style="vertical-align: top;">                         <span style="color: #0033ff; font-weight: bold;">false</span>, <span style="color: #000000; font-weight: bold;">1</span>, .5, <span style="color: #0033ff; font-weight: bold;">false</span>, <span style="color: #990000;">"oneSidedPlatform2"</span><span style="color: #000000;">)</span>;</span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">So what does it mean the platform is one-sided? It means that when the hero is below that platform, it could jump on it but when the hero falls on that platform, it will stop him. So how are we going to do make platforms one-sided? We can manipulate contacts
    so the Box2B engine will not perform default action which is the collision reaction that prevents objects overlapping when the collision is detected.</p>
<p style="text-align: justify;">In order to do that we need to create our own custom contact listener that will extend from the b2ContactListener and register it to the world object using the SetContactListener method.</p>
<p>According to the documentation there are four type of events:</p>
<ul>
    <li><strong>Begin Contact Event</strong> called when two fixtures begin to everlap</li>
    <li><strong>Pre-Solve Event</strong> called after collision detection but before collision resolution (this is when we can stop resolution from happening)</li>
    <li><strong>Post-Solve Event</strong> called after collision resolution (useful when you want to read collision impulse results)</li>
    <li><strong>End Contact Event </strong>called when two fixtures stop overlapping</li>
</ul>
<p>&nbsp;</p>
<p style="text-align: justify;">So first let's create our custom contact listener and use Pre-Solve event to stop collision reaction from happening:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <table class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <tbody>
                <tr class="li1">
                    <td style="width: 1px; background: #f0f0f0; vertical-align: top; color: #676f73; border-right: 1px dotted #dddddd; font-size: 12px; text-align: right;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre>
                    </td>
                    <td style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;">
                        <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #9900cc; font-weight: bold;">class</span> CustomContactListener extends b2ContactListener</span>
<span style="vertical-align: top;"><span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">  override <span style="color: #0033ff; font-weight: bold;">public</span> <span style="color: #339966; font-weight: bold;">function</span> PreSolve<span style="color: #000000;">(</span>contact<span style="color: #000000; font-weight: bold;">:</span>b2Contact, oldManifold<span style="color: #000000; font-weight: bold;">:</span>b2Manifold<span style="color: #000000;">)</span><span style="color: #000000; font-weight: bold;">:</span><span style="color: #0033ff; font-weight: bold;">void</span> </span>
<span style="vertical-align: top;">  <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> fixtureA<span style="color: #000000; font-weight: bold;">:</span>b2Fixture = contact.GetFixtureA<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> fixtureB<span style="color: #000000; font-weight: bold;">:</span>b2Fixture = contact.GetFixtureB<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>

<span style="vertical-align: top;">    <span style="color: #009900;">// If any of the two fixtures doesn't have the user data object then return,</span></span>
<span style="vertical-align: top;">    <span style="color: #009900;">// as we need 'hero' and 'oneSidedPlatform' objects only.</span></span>
<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span><span style="color: #000000; font-weight: bold;">!</span>fixtureA.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000; font-weight: bold;">||</span> <span style="color: #000000; font-weight: bold;">!</span>fixtureB.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">return</span>;</span>

<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> nameA<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">String</span></a> = <span style="color: #000000;">(</span>fixtureA.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">as</span> UserDataInfo<span style="color: #000000;">)</span>.<span style="color: #004993;">name</span>;</span>
<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> nameB<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=string%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:string.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">String</span></a> = <span style="color: #000000;">(</span>fixtureB.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">as</span> UserDataInfo<span style="color: #000000;">)</span>.<span style="color: #004993;">name</span>;</span>

<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>nameA <span style="color: #000000; font-weight: bold;">!</span>= <span style="color: #990000;">"hero"</span> <span style="color: #000000; font-weight: bold;">&amp;&amp;</span> nameB <span style="color: #000000; font-weight: bold;">!</span>= <span style="color: #990000;">"hero"</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">return</span>;</span>
<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>nameA.<span style="color: #004993;">indexOf</span><span style="color: #000000;">(</span><span style="color: #990000;">"oneSidedPlatform"</span><span style="color: #000000;">)</span> == <span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">1</span> <span style="color: #000000; font-weight: bold;">&amp;&amp;</span> nameB.<span style="color: #004993;">indexOf</span><span style="color: #000000;">(</span><span style="color: #990000;">"oneSidedPlatform"</span><span style="color: #000000;">)</span> == <span style="color: #000000; font-weight: bold;">-</span><span style="color: #000000; font-weight: bold;">1</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">return</span>;</span>

<span style="vertical-align: top;">    <span style="color: #009900;">// Now find out which is hero and which is platform and get their position and height.</span></span>
<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> heroPos<span style="color: #000000; font-weight: bold;">:</span>b2Vec2, platformPos<span style="color: #000000; font-weight: bold;">:</span>b2Vec2;</span>
<span style="vertical-align: top;">    <span style="color: #6699cc; font-weight: bold;">var</span> heroHeight<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>, platformHeight<span style="color: #000000; font-weight: bold;">:</span><a href="http://www.google.com/search?q=number%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:number.html&amp;filter=0&amp;num=100&amp;btnI=lucky"><span style="color: #004993;">Number</span></a>;</span>

<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>nameA == <span style="color: #990000;">"hero"</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;">    <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">      heroPos = fixtureA.GetBody<span style="color: #000000;">(</span><span style="color: #000000;">)</span>.GetPosition<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">      heroHeight = <span style="color: #000000;">(</span>fixtureA.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">as</span> UserDataInfo<span style="color: #000000;">)</span>.<span style="color: #004993;">height</span>;</span>

<span style="vertical-align: top;">      platformPos = fixtureB.GetBody<span style="color: #000000;">(</span><span style="color: #000000;">)</span>.GetPosition<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">      platformHeight = <span style="color: #000000;">(</span>fixtureB.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">as</span> UserDataInfo<span style="color: #000000;">)</span>.<span style="color: #004993;">height</span>;</span>
<span style="vertical-align: top;">    <span style="color: #000000;">}</span></span>
<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">else</span></span>
<span style="vertical-align: top;">    <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">      platformPos = fixtureA.GetBody<span style="color: #000000;">(</span><span style="color: #000000;">)</span>.GetWorldCenter<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">      platformHeight = <span style="color: #000000;">(</span>fixtureA.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">as</span> UserDataInfo<span style="color: #000000;">)</span>.<span style="color: #004993;">height</span>;</span>

<span style="vertical-align: top;">      heroPos = fixtureB.GetBody<span style="color: #000000;">(</span><span style="color: #000000;">)</span>.GetWorldCenter<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">      heroHeight = <span style="color: #000000;">(</span>fixtureB.GetUserData<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #0033ff; font-weight: bold;">as</span> UserDataInfo<span style="color: #000000;">)</span>.<span style="color: #004993;">height</span>;</span>
<span style="vertical-align: top;">    <span style="color: #000000;">}</span></span>

<span style="vertical-align: top;">    <span style="color: #009900;">// If the bottom part of the hero is under a top part of a platform then do not create collision.</span></span>
<span style="vertical-align: top;">    <span style="color: #009900;">// As the hero position is in the middle of the hero object we need to add half of his height</span></span>
<span style="vertical-align: top;">    <span style="color: #009900;">// to get the position at the bottom of his legs. Similar for platform but we need to substract</span></span>
<span style="vertical-align: top;">    <span style="color: #009900;">// half of it's height to get the position of the top of it.</span></span>
<span style="vertical-align: top;">    <span style="color: #0033ff; font-weight: bold;">if</span> <span style="color: #000000;">(</span>heroPos.<span style="color: #004993;">y</span> <span style="color: #000000; font-weight: bold;">+</span> heroHeight <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span> <span style="color: #000000; font-weight: bold;">&gt;</span> platformPos.<span style="color: #004993;">y</span> <span style="color: #000000; font-weight: bold;">-</span> platformHeight <span style="color: #000000; font-weight: bold;">/</span> <span style="color: #000000; font-weight: bold;">2</span><span style="color: #000000;">)</span></span>
<span style="vertical-align: top;">    <span style="color: #000000;">{</span></span>
<span style="vertical-align: top;">      contact.SetEnabled<span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">false</span><span style="color: #000000;">)</span>;</span>
<span style="vertical-align: top;">    <span style="color: #000000;">}</span></span>
<span style="vertical-align: top;">  <span style="color: #000000;">}</span></span>
<span style="vertical-align: top;"><span style="color: #000000;">}</span></span></pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<p>&nbsp;</p>
<p style="text-align: justify;">When PreSolve event handler is called, it receives two objects and the first one - contact - is very useful to us as this is the same type of contact as we used when going through the hero's collisions. From the contact we can get two fixtures. We are
    only interested in doing something if one fixture is the hero object and other one is one of the one-sided platforms. We use the name property from our UserDataInfo object that is referenced from fixture's userData property. In a real case scenario
    it would be a better idea to compare types of the objects rather than their names but for the purpose of this article it is fine. When we confirm that this collision happens for the hero and the one-sided platform we identify which is which and also
    read their current positions and their height. Having these two pairs of information, the last thing to do is to check if the hero bottom part (hero's position plus half of his height) is above or below the top part of a platform (platform's position
    minus half of its height). If the hero is above then do nothing - the hero will land on the platform. If he is below than set the contact disabled what will stop Box2D from doing collision reaction and the hero will fly through a platform.</p>
<p style="text-align: justify;">So the last bit is to register the object to the world object in the createWorld function:</p>
<div class="rj_insertcode">
    <div class="rj_insertcode_actionscript3">
        <div class="actionscript3" style="border-collapse: collapse; width: 100%; border: 1px solid #054b6e; background: #f8f8f8;">
            <pre style="margin: 0; background: none; vertical-align: top; padding: 0px 4px; font-size: 12px;"><span style="vertical-align: top;"><span style="color: #009900;">// Register custom contact listener for one-sided platforms</span></span>
<span style="vertical-align: top;">ourWorld.SetContactListener<span style="color: #000000;">(</span><span style="color: #0033ff; font-weight: bold;">new</span> CustomContactListener<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</span></pre>
        </div>
    </div>
</div>
<p>&nbsp;</p>
<p>And here is how our hero jumps through the platforms:</p>
<p style="text-align: center;"><object data="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_6_onesided_platforms.swf" type="application/x-shockwave-flash" width="500" height="480"><param name="src" value="http://sierakowski.eu/examples/box2d_part1/Box2dBasicsPart1_6_onesided_platforms.swf" /><param name="play" value="false" /><param name="wmode" value="window" />
</object></p>
<p>&nbsp;</p>
<p style="text-align: justify;">I think this is a good point to end the first part of the Box2D tutorial. In the second part I will cover all various types of joints, how to control objects with mouse, how to use water and how to use your own graphical assets - display list sprites
    and Starling sprites. I don't want to say when it will be published as it took me almost a year to complete this one, I was so busy with my projects and the full time work and I create all different bits for this article but never had enough spare
    time to put it together. But hopefully it won't take long. Anyway there are plenty of really good tutorials available on the internet and having your current knowledge of Box2D will make it easier to understand code samples in different languages.</p>
<p style="text-align: justify;">&nbsp;</p>
<h2>Project files</h2>
<p class="globe">Project files on my GitHub: <a href="https://github.com/wsierakowski/Box2D-basics-part1">https://github.com/wsierakowski/Box2D-basics-part1</a></p>
<h2>Links to manuals and useful tutorials</h2>
<p>There are plenty of resources for Box2D. Here are the ones I use most often:</p>
<ul>
    <li>Official Box2D manual: <a href="http://www.box2d.org/manual.html">http://www.box2d.org/manual.html</a></li>
    <li>Official Box2d Flash port manual: <a href="http://www.box2dflash.org/docs/2.0.2/manual">http://www.box2dflash.org/docs/2.0.2/manual</a></li>
    <li>Anatomy of a collision on iforce2d blog: <a href="http://www.iforce2d.net/b2dtut/collision-anatomy">http://www.iforce2d.net/b2dtut/collision-anatomy</a></li>
    <li>Collection of many good code samples on Emanuele Feronato blog: <a href="http://www.emanueleferonato.com/category/box2d/">http://www.emanueleferonato.com/category/box2d/</a></li>
</ul>
<p>&nbsp;</p>
<p>Please note that whenever I use quote sign for sentences - I'm quoting the Box2D documentation.</p>
<p>I have also learnt a lot from these tutorials:</p>
<ul>
    <li><a href="http://plasticsturgeon.com/2010/08/making-an-as3-game-in-box2d-flash-version-2-0-hello-world-box2d/2/">http://plasticsturgeon.com/2010/08/making-an-as3-game-in-box2d-flash-version-2-0-hello-world-box2d/2/</a></li>
    <li><a href="http://chrismweb.com/2011/06/01/using-box2d-to-create-a-side-scrolling-game-part-2-adding-keyboard-input-and-an-enemy/">http://chrismweb.com/2011/06/01/using-box2d-to-create-a-side-scrolling-game-part-2-adding-keyboard-input-and-an-enemy/</a></li>
</ul>
<p>&nbsp;</p>
<p></p>
<div id="jc">
    <div id="comments">
        <h4>Comments imported from the original article @sierakowski.eu</h4>
        <div id="comments-list" class="comments-list">
            <div id="comment-item-190" class="even">
                <div class="rbox">
                    <div class="rbox_tr">
                        <div class="rbox_tl">
                            <div class="rbox_t">&nbsp;</div>
                        </div>
                    </div>
                    <div class="rbox_m">
                        <div class="comment-box usertype-guest"><span class="comments-vote"> <span id="comment-vote-holder-189"> <a class="vote-good" title="Good comment!">+</a><a class="vote-poor" title="Poor comment!">-</a> <span class="vote-good">+1</span> </span>
                            </span> <a class="comment-anchor">#6</a> <span class="comment-author">David Hertz</span> <span class="comment-date">2013-03-09 06:46</span>
                            <div id="comment-body-176" class="comment-body">Please make the second part!!<br /><br />Regards from Mexico! <img src="http://sierakowski.eu/components/com_jcomments/images/smiles/lol.gif" alt=":lol:" border="0" /></div>
                            <span class="comments-buttons"> <a>Quote</a> </span></div>
                        <div class="clear">&nbsp;</div>
                    </div>
                    <div class="rbox_br">
                        <div class="rbox_bl">
                            <div class="rbox_b">&nbsp;</div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="comment-item-190" class="even">
                <div class="rbox">
                    <div class="rbox_tr">
                        <div class="rbox_tl">
                            <div class="rbox_t">&nbsp;</div>
                        </div>
                    </div>
                    <div class="rbox_m">
                        <div class="comment-box usertype-guest"><span class="comments-vote"> <span id="comment-vote-holder-189"> <a class="vote-good" title="Good comment!">+</a><a class="vote-poor" title="Poor comment!">-</a> <span class="vote-good">+2</span> </span>
                            </span> <a class="comment-anchor">#5</a> <span class="comment-author">Hector</span> <span class="comment-date">2013-02-09 13:41</span>
                            <div id="comment-body-190" class="comment-body">I really enjoyed this great tutorial. Great Job! Thank you!</div>
                            <span class="comments-buttons"> <a>Quote</a> </span></div>
                        <div class="clear">&nbsp;</div>
                    </div>
                    <div class="rbox_br">
                        <div class="rbox_bl">
                            <div class="rbox_b">&nbsp;</div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="comment-item-190" class="even">
                <div class="rbox">
                    <div class="rbox_tr">
                        <div class="rbox_tl">
                            <div class="rbox_t">&nbsp;</div>
                        </div>
                    </div>
                    <div class="rbox_m">
                        <div class="comment-box usertype-guest"><span class="comments-vote"> <span id="comment-vote-holder-189"> <a class="vote-good" title="Good comment!">+</a><a class="vote-poor" title="Poor comment!">-</a> <span class="vote-good">+2</span> </span>
                            </span> <a class="comment-anchor">#4</a> <span class="comment-author">wojciech</span> <span class="comment-date">2012-11-15 22:05</span>
                            <div id="comment-body-190" class="comment-body">Thanks @iforce2d. Your's website is a really great resource of Box2D tutorials!</div>
                            <span class="comments-buttons"> <a>Quote</a> </span></div>
                        <div class="clear">&nbsp;</div>
                    </div>
                    <div class="rbox_br">
                        <div class="rbox_bl">
                            <div class="rbox_b">&nbsp;</div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="comment-item-190" class="even">
                <div class="rbox">
                    <div class="rbox_tr">
                        <div class="rbox_tl">
                            <div class="rbox_t">&nbsp;</div>
                        </div>
                    </div>
                    <div class="rbox_m">
                        <div class="comment-box usertype-guest"><span class="comments-vote"> <span id="comment-vote-holder-189"> <a class="vote-good" title="Good comment!">+</a><a class="vote-poor" title="Poor comment!">-</a> <span class="vote-good">+3</span> </span>
                            </span> <a class="comment-anchor">#3</a> <span class="comment-author">iforce2d</span> <span class="comment-date">2012-11-14 21:10</span>
                            <div id="comment-body-190" class="comment-body">Hey, nice job! You have packed a lot of info in here!</div>
                            <span class="comments-buttons"> <a>Quote</a> </span></div>
                        <div class="clear">&nbsp;</div>
                    </div>
                    <div class="rbox_br">
                        <div class="rbox_bl">
                            <div class="rbox_b">&nbsp;</div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="comment-item-190" class="even">
                <div class="rbox">
                    <div class="rbox_tr">
                        <div class="rbox_tl">
                            <div class="rbox_t">&nbsp;</div>
                        </div>
                    </div>
                    <div class="rbox_m">
                        <div class="comment-box usertype-guest"><span class="comments-vote"> <span id="comment-vote-holder-189"> <a class="vote-good" title="Good comment!">+</a><a class="vote-poor" title="Poor comment!">-</a> <span class="vote-good">+2</span> </span>
                            </span> <a class="comment-anchor">#2</a> <span class="comment-author">Armin</span> <span class="comment-date">2012-04-18 11:13</span>
                            <div id="comment-body-190" class="comment-body">Great tut but is there any chance to post the source code on the github or something similar?</div>
                            <span class="comments-buttons"> <a>Quote</a> </span></div>
                        <div class="clear">&nbsp;</div>
                    </div>
                    <div class="rbox_br">
                        <div class="rbox_bl">
                            <div class="rbox_b">&nbsp;</div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="comment-item-190" class="even">
                <div class="rbox">
                    <div class="rbox_tr">
                        <div class="rbox_tl">
                            <div class="rbox_t">&nbsp;</div>
                        </div>
                    </div>
                    <div class="rbox_m">
                        <div class="comment-box usertype-guest"><span class="comments-vote"> <span id="comment-vote-holder-189"> <a class="vote-good" title="Good comment!">+</a><a class="vote-poor" title="Poor comment!">-</a> <span class="vote-good">+2</span> </span>
                            </span> <a class="comment-anchor">#1</a> <span class="comment-author">Fuldner</span> <span class="comment-date">2012-02-18 11:12</span>
                            <div id="comment-body-190" class="comment-body">Awesome tutorial. Thanks so much for sharing it!</div>
                            <span class="comments-buttons"> <a>Quote</a> </span></div>
                        <div class="clear">&nbsp;</div>
                    </div>
                    <div class="rbox_br">
                        <div class="rbox_bl">
                            <div class="rbox_b">&nbsp;</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
